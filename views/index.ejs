<%- include('partials/header.ejs') %>
<div class="box" id="heading">
    <h1>
        <%= listTitle %>
    </h1>
</div>
<div class="box">
   <% newListItems.forEach(item => { %>
        <div class="item">
            <input type="checkbox" <% if (item.checked) { %> checked <% } %> data-id="<%= item._id %>">
            <p>
                <%= item.name %>
            </p>
        </div>
    <% }) %>
    <form class="item" action="/" method="post">
        <input type="text" name="newItem" placeholder="New Item" autocomplete="off" />
        <button type="submit" name="list" value="<%= listTitle %>">+</button>
    </form>
</div>
<script>
    document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
        checkbox.addEventListener('change', function() {
            fetch('/update', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams({
                    id: this.getAttribute('data-id'),
                    checked: this.checked
                })
            });
        });
    });
</script>
<%- include('partials/footer.ejs') %>
